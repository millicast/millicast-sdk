function e(e,t,n,r){return new(n||(n=Promise))((function(s,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}const t=m;!function(){const e=m,t=d();for(;;)try{if(204686===-parseInt(e(572))/1*(-parseInt(e(584))/2)+parseInt(e(713))/3*(parseInt(e(594))/4)+-parseInt(e(683))/5*(-parseInt(e(473))/6)+-parseInt(e(614))/7*(parseInt(e(480))/8)+-parseInt(e(638))/9*(parseInt(e(656))/10)+-parseInt(e(640))/11*(parseInt(e(576))/12)+parseInt(e(603))/13)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const n=navigator[t(587)][t(450)]("Apple");function r(e,n){const r=t;let s=new Uint8Array((0|e[r(751)])+(0|n.byteLength));return s[r(644)](e,0),s[r(644)](n,0|e.byteLength),s}const s=(e,n,r,s)=>{const i=t,o=s[i(730)]||1;n*=o,r*=o;const a=(l=e)instanceof ArrayBuffer?l:l[t(711)],c=(e[i(735)]||0)+e.byteLength,d=(e[i(735)]||0)+n;var l;let u=Math.max(0,Math[i(497)](d,c)),h=Math[i(497)](u+Math.max(r,0),c);return u/=o,h/=o,new s(a,u,h-u)};function i(e,t=0,n=1/0){return s(e,t,n,Uint8Array)}function o(e){const n=function(e){const n=t;let r="";for(let t=0;t<e[n(552)];t+=16e3){const s=e[n(499)](t,t+16e3);r+=String[n(479)][n(561)](null,s)}return r}(i(e));return btoa(n)}window.downloadToFile=(e,n,r=t(571))=>{const s=t,i=document[s(478)]("a"),o=new Blob([e],{type:r});i[s(592)]=URL.createObjectURL(o),i.download=n,i[s(739)](),URL[s(534)](i[s(592)])};class a{static get[t(637)](){return 1}static get IDR(){return 5}static get[t(500)](){return 6}static get[t(511)](){return 7}static get[t(669)](){return 8}static get AUD(){return 9}static get TYPES(){const e=t;return{[a[e(709)]]:e(709),[a[e(500)]]:e(500),[a[e(511)]]:"SPS",[a[e(669)]]:e(669),[a.NDR]:e(637),[a[e(487)]]:e(487)}}static type(e){const n=t;return e[n(540)]in a[n(490)]?a[n(490)][e[n(540)]]:n(456)}constructor(e){const n=t;this.payload=e,this.nri=(96&this[n(463)][0])>>5,this.ntype=31&this[n(463)][0],this[n(515)]=1==this.ntype||5==this[n(540)],this.stype="",this[n(666)]=!1}[t(691)](){const e=t;return a.type(this)+": NRI: "+this[e(521)]()}[t(521)](){return this[t(763)]}[t(593)](){return this[t(540)]}isKeyframe(){return this[t(540)]===a.IDR}[t(754)](){return this[t(463)]}getPayloadSize(){const e=t;return this[e(463)][e(751)]}[t(458)](){return 4+this[t(625)]()}[t(526)](){const e=t,n=new Uint8Array(this.getSize());return new DataView(n[e(711)])[e(559)](0,this[e(458)]()-4),n[e(644)](this[e(754)](),4),n}}class c{constructor(e){const n=t;this[n(717)]=e,this[n(498)]=0,this.bitLength=8*e[n(751)]}setData(e){const n=t;this[n(717)]=e,this[n(498)]=0,this.bitLength=8*e[n(751)]}get bitsAvailable(){const e=t;return this[e(523)]-this[e(498)]}[t(655)](e){const n=t;if(this[n(649)]<e)return!1;this[n(498)]+=e}[t(565)](e,n=!0){const r=t;return this[r(659)](e,this[r(498)],n)}getBits(e,n,r=!0){const s=t;if(this[s(649)]<e)return 0;const i=n%8,o=this[s(717)][n/8|0]&255>>>i,a=8-i;if(a>=e)return r&&(this[s(498)]+=e),o>>a-e;{r&&(this.index+=a);const t=e-a;return o<<t|this[s(659)](t,n+a,r)}}[t(522)](){const e=t;let n;for(n=0;n<this[e(523)]-this[e(498)];++n)if(0!==this[e(659)](1,this.index+n,!1))return this[e(498)]+=n,n;return n}[t(507)](){this[t(655)](1+this.skipLZ())}[t(670)](){const e=t;this.skipBits(1+this[e(522)]())}[t(533)](){const e=t,n=this.skipLZ();return this[e(565)](n+1)-1}[t(671)](){const e=this[t(533)]();return 1&e?1+e>>>1:-1*(e>>>1)}[t(549)](){return 1===this[t(565)](1)}[t(612)](e=1){return this[t(565)](8*e)}[t(743)](){return this[t(565)](16)}[t(504)](){return this[t(565)](32)}}function d(){const e=["readUShort","STTS","keySystem","len","saio","onMSEClose","box","initialized","byteLength","videoSampleAuxInfo","concat","getPayload","listener","mp4a","minf","open","VMHD","Received ","volume","systemID","nri","trak","includes","isNonSync","prototype","map","clRtcDrmDebugLog","encv","UNKNOWN","track","getSize","disableRemotePlayback","getVideoFrames","isReset",'<KID ALGID="AESCTR" ',"payload","appendBufferError","[H264Parser] No VCL NALUs found","remuxController","endOfStream","mp4track","tracks","sourceBuffer","nextDts","sampleAuxInfo","2022CxgyPJ","bind","isTypeSupported","[H264Parser] IDR without SPS/PPS, not suitable for recovery","substring","createElement","fromCharCode","23216vbejGZ","stbl","parsePPS","enca","mse","STSZ","[H264Parser] Both IDR and non-IDR VCL NALUs found in the same frame","AUD","skipScalingList","setUint16","TYPES","keyId","STCO","getUint8","assign","tencIvRecord","h264","min","index","subarray","SEI","com.widevine","stts","webkitsourceclose","readUInt","schm","patchSampleAuxinfo","skipUEG","initSegment","Num frames in chunk: ","seq","SPS","encrypted","addSourceBuffer","mdhd","isvcl","POSITIVE_INFINITY","warn","removeSourceBuffer","ready",'/mp4; codecs="',"getNri","skipLZ","bitLength","STSD","flush","getData","smhd","stype","readyToDecode","mvhd","dOps","licenseUrl","readUEG","revokeObjectURL","</LA_URL>","mediaDuration","codec","[MSE] source buffer error","parseNAL","ntype",'VALUE="',"</WRMHEADER>","endMSE","</DATA>","[MSE] buffer error:","shift","url","getFramePayload","readBoolean"," samples - expected 1","frma","length","Checking codec","mfhd","mseReady","duration","http://schemas.microsoft.com/DRM/2007/03/PlayReadyHeader","trun","setUint32","No A/V data","apply",'<WRMHEADER xmlns="',"push","traf","readBits","trex","channelCount","call","cryptPattern","trackTypes","application/octet-stream","63977XHTQGK","ftyp","error","info","338484HHqdUw","isKeyframe","nalus","no video element were found to render, provide a valid video element","size","sourceclose","addEventListener","Buffered range ","4XltwlN","queue","createBuffer","vendor","<KIDS>","esds","mediaSource","isDependedOn","href","type","5280ETJYkA","start",'" version="',"remuxer","mseEnded","options","frameCounter","join","createObjectURL","6688357kkipZQ","hdlr","getTrackID","dbgQueue","mp4","dispatch","charCodeAt","readSPS","MediaSource","readUByte","buffer error","889kclXTz","video","setupMSE","senc","mdia","toISOString","onError","<DATA>","offAll","audio","both","getPayloadSize","function","SMHD","com.microsoft.playready.recommendation"," (remove)","tkhd","feed","</PROTECTINFO>","pps","isReady","timestamp","encryptionScheme","NDR","1591281LjClYN","audioSampleAuxInfo","22TBXYsR","HDLR_TYPES","reportDiscontinuity","config","set","replaceAll","stsd","timescale","readyState","bitsAvailable","message","saiIvSize","resetTrack","ceil","remove","skipBits","20OvfYWx","irrecoverableError","onBuffer","getBits","ended","remux","keyFrame","node","vmhd","com.apple.fps","isfmb","height","dref","PPS","skipEG","readEG","schi","src","onMSEOpen","DINF","org.w3.clearkey","end","buffered","tenc","ManagedMediaSource","audiosamplerate","clRtcDrmCreateMediaDump","2785LQsmut","sdtp","slice","calculateExpectedSizeFromSai","downloadToFile","off","isSupported","<LA_URL>","toString","mvex","onBufferError","STSC","jmuxer"," - ","dts","units","waitingForIdr","moof","[MSE] sourceopen","string","mdat","samples","flags","onReady","destroy","FTYP","IDR","timestamp gap: ","buffer","drm","348HnTPGS","types","addTrack","indexOf","data","reduce","moov","saiz","tfdt","sinf","updating","mediasource is not available to end: ","4.3.0.0","releaseBuffer","videoElement","[MSE] error: ","bufferControllers","BYTES_PER_ELEMENT","initBrowser","Opus","dependsOn","sourceopen","byteOffset","Browser does not support codec","doAppend","pssh","click","width","sps","extractNALUs"];return(d=function(){return e})()}class l{static[t(742)](e,n){const r=t;let s=[],i=!1,o=!1,c=!1,d=!1,l=0,u=0,h=0,f=[];for(;l<=e.byteLength;){if(l<e.byteLength){const t=e[l++];0!==t?(1===t&&u>1&&(h=u>2?4:3,f.push(l)),u=0):++u}else h=0,f.push(l++);if(f.length>1){const t=f.shift(),r=f[0]-h;if(t<r){let h=!1;const f=31&e[t];if(f===a.NDR?o=!0:f===a.IDR?i=!0:f===a.SPS?(h=c,c=!0):f===a.PPS&&(h=d,d=!0),!h)if(!n||f!==a.NDR&&f!==a.IDR)s.push(e.subarray(t,r));else{const n=new Uint8Array(r-t);let i=0;for(l=t,u=0;l<r;){let t=e[l++];u>1&&3===t&&(u=0,t=e[l++]),0!==t?u=0:++u,n[i++]=t}s.push(n.subarray(0,i))}}}}let p=!0,m=!1;return o||i?o&&i&&(console[r(517)](r(486)),p=!1):(console[r(517)](r(465)),p=!1),i&&(c&&d?m=!0:console[r(517)](r(476))),{valid:p,idr:m,nalus:s}}static[t(488)](e,n){const r=t;let s,i=8,o=8;for(let t=0;t<n;t++)0!==o&&(s=e[r(671)](),o=(i+s+256)%256),i=0===o?i:o}static[t(610)](e){const n=t;let r,s,i,o,a,d,u=new c(e),h=0,f=0,p=0,m=0,y=1;if(u[n(612)](),r=u[n(612)](),u[n(565)](5),u[n(655)](3),u[n(612)](),u[n(507)](),100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r){var w=u[n(533)]();if(3===w&&u[n(655)](1),u[n(507)](),u.skipUEG(),u[n(655)](1),u[n(549)]()){d=3!==w?8:12;for(let e=0;e<d;++e)u[n(549)]()&&(e<6?l[n(488)](u,16):l[n(488)](u,64))}}u.skipUEG();var g=u.readUEG();if(0===g)u[n(533)]();else if(1===g){u[n(655)](1),u[n(670)](),u[n(670)](),s=u[n(533)]();for(let e=0;e<s;++e)u[n(670)]()}if(u[n(507)](),u[n(655)](1),i=u[n(533)](),o=u[n(533)](),a=u.readBits(1),0===a&&u[n(655)](1),u[n(655)](1),u.readBoolean()&&(h=u[n(533)](),f=u.readUEG(),p=u[n(533)](),m=u.readUEG()),u[n(549)]()){if(u.readBoolean()){let e;switch(u[n(612)]()){case 1:e=[1,1];break;case 2:e=[12,11];break;case 3:e=[10,11];break;case 4:e=[16,11];break;case 5:e=[40,33];break;case 6:e=[24,11];break;case 7:e=[20,11];break;case 8:e=[32,11];break;case 9:e=[80,33];break;case 10:e=[18,11];break;case 11:e=[15,11];break;case 12:e=[64,33];break;case 13:e=[160,99];break;case 14:e=[4,3];break;case 15:e=[3,2];break;case 16:e=[2,1];break;case 255:e=[u.readUByte()<<8|u.readUByte(),u.readUByte()<<8|u[n(612)]()]}e&&e[0]>0&&e[1]>0&&(y=e[0]/e[1])}u.readBoolean()&&u[n(655)](1),u[n(549)]()&&(u[n(655)](4),u[n(549)]()&&u[n(655)](24)),u[n(549)]()&&(u[n(507)](),u[n(507)]()),u.readBoolean()&&(u.readUInt(),u[n(504)](),u.readBoolean())}return{width:Math[n(653)]((16*(i+1)-2*h-2*f)*y),height:(2-a)*(o+1)*16-(a?2:4)*(p+m)}}static parseHeader(e){const n=t;let r=new c(e[n(754)]());r[n(612)](),e[n(666)]=0===r[n(533)](),e[n(528)]=r[n(533)]()}constructor(e){this[t(597)]=e,this.track=e.mp4track}parseSPS(e){const n=t;var r=l[n(610)](new Uint8Array(e));this[n(457)][n(740)]=r[n(740)],this[n(457)].height=r.height,this.track[n(741)]=[new Uint8Array(e)],this[n(457)][n(537)]="avc1.";let s=new DataView(e[n(711)],e[n(735)]+1,4);for(let e=0;e<3;++e){var i=s[n(493)](e)[n(691)](16);i[n(552)]<2&&(i="0"+i),this[n(457)][n(537)]+=i}}[t(482)](e){const n=t;this[n(457)][n(633)]=[new Uint8Array(e)]}[t(539)](e){const n=t;if(!e)return!1;let r=!1;switch(e[n(593)]()){case a[n(709)]:case a[n(637)]:r=!0;break;case a[n(669)]:!this.track[n(633)]&&(this.parsePPS(e.getPayload()),!this[n(597)].readyToDecode&&this[n(457)].pps&&this[n(457)][n(741)]&&(this[n(597)][n(529)]=!0)),r=!0;break;case a[n(511)]:!this[n(457)][n(741)]&&(this.parseSPS(e[n(754)]()),!this[n(597)][n(529)]&&this[n(457)][n(633)]&&this[n(457)][n(741)]&&(this.remuxer[n(529)]=!0)),r=!0;break;case a.AUD:break;case a[n(500)]:r=!0}return r}}class u{constructor(e){this[t(755)]={},this.type=""|e}on(e,n){const r=t;return!this.listener[e]&&(this.listener[e]=[]),this[r(755)][e][r(563)](n),!0}[t(688)](e,n){const r=t;if(this[r(755)][e]){var s=this[r(755)][e][r(716)](n);return s>-1&&this[r(755)][e].splice(s,1),!0}return!1}[t(622)](){this.listener={}}[t(608)](e,n){const r=t;return!!this[r(755)][e]&&(this[r(755)][e][r(453)]((e=>{e[r(561)](null,[n])})),!0)}}class h{constructor(e){const n=t;this.drm=e,h[n(714)]={avc1:[],encv:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],Opus:[],dOps:[],enca:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],pssh:[],sinf:[],frma:[],schm:[],schi:[],tenc:[],saiz:[],saio:[],senc:[]};for(let e in h[n(714)])h.types[e]=[e[n(609)](0),e[n(609)](1),e[n(609)](2),e[n(609)](3)];const r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),s=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);h[n(641)]={video:r,audio:s};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);h.STTS=h.STSC=h[n(492)]=o,h.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),h[n(759)]=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),h[n(627)]=new Uint8Array([0,0,0,0,0,0,0,0]),h[n(524)]=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);h[n(708)]=h[n(749)](h[n(714)][n(573)],a,d,a,c),h.DINF=h[n(749)](h.types.dinf,h.box(h[n(714)][n(668)],i))}static[t(749)](e,...n){const r=t;let s,i=8,o=n[r(552)],a=o;for(;o--;)n[o]&&(i+=n[o][r(751)]);for(s=new Uint8Array(i),s[0]=i>>>24,s[1]=i>>>16&255,s[2]=i>>>8&255,s[3]=255&i,s.set(e,4),o=0,i=8;o<a;++o)n[o]&&(s[r(644)](n[o],i),i+=n[o][r(751)]);return s}[t(604)](e){const n=t;return h.box(h[n(714)][n(604)],h[n(641)][e])}[t(703)](e){const n=t;return h[n(749)](h[n(714)][n(703)],e)}mdhd(e,n){const r=t;return h.box(h[r(714)][r(514)],new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24,e>>>16&255,e>>>8&255,255&e,0,0,0,0,85,196,0,0]))}[t(618)](e){const n=t;return h[n(749)](h[n(714)][n(618)],this[n(514)](e[n(647)],e.duration),this[n(604)](e[n(593)]),this[n(757)](e))}[t(554)](e){const n=t;return h.box(h.types[n(554)],new Uint8Array([0,0,0,0,e>>>24,e>>>16&255,e>>>8&255,255&e]))}minf(e){const n=t;return e[n(593)]===n(623)?h[n(749)](h.types[n(757)],h[n(749)](h[n(714)][n(527)],h[n(627)]),h[n(675)],this[n(481)](e)):h.box(h[n(714)][n(757)],h[n(675)],this[n(481)](e),h[n(749)](h[n(714)][n(664)],h[n(759)]))}[t(700)](e,n,r){const s=t;return h[s(749)](h[s(714)][s(700)],this[s(554)](e),this[s(564)](r,n))}[t(719)](e,n,r){const s=t;let i=e.length,o=[];for(;i--;)o[i]=this[s(764)](e[i]);return h[s(749)][s(561)](null,[h[s(714)][s(719)],this[s(530)](r,n),this.pssh(e)][s(753)](o).concat(this[s(692)](e)))}[t(692)](e){const n=t;let r=e[n(552)],s=[];for(;r--;)s[r]=this.trex(e[r]);return h[n(749)][n(561)](null,[h[n(714)][n(692)]][n(753)](s))}mvhd(e,n){const r=t;let s=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,e>>>24,e>>>16&255,e>>>8&255,255&e,n>>>24,n>>>16&255,n>>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return h[r(749)](h[r(714)].mvhd,s)}[t(684)](e){const n=t;let r=e.samples||[],s=new Uint8Array(4+r[n(552)]);for(let e=0;e<r[n(552)];e++){const t=r[e][n(705)];s[e+4]=t[n(733)]<<4|t[n(591)]<<2|t.hasRedundancy}return h[n(749)](h[n(714)][n(684)],s)}[t(481)](e){const n=t;return h[n(749)](h.types.stbl,this.stsd(e),h[n(749)](h[n(714)][n(502)],h[n(744)]),h[n(749)](h[n(714)].stsc,h[n(694)]),h[n(749)](h.types.stsz,h[n(485)]),h[n(749)](h[n(714)].stco,h[n(492)]))}[t(455)](e){const n=t;let r,s,i,o=[],a=[];for(r=0;r<e[n(741)][n(552)];r++)s=e[n(741)][r],i=s[n(751)],o[n(563)](i>>>8&255),o.push(255&i),o=o[n(753)](Array[n(452)][n(685)][n(568)](s));for(r=0;r<e[n(633)][n(552)];r++)s=e[n(633)][r],i=s[n(751)],a[n(563)](i>>>8&255),a.push(255&i),a=a[n(753)](Array[n(452)][n(685)][n(568)](s));const c=h[n(749)](h.types.avcC,new Uint8Array([1,o[3],o[4],o[5],255,224|e[n(741)][n(552)]][n(753)](o).concat([e[n(633)][n(552)]])[n(753)](a))),d=e[n(740)],l=e[n(667)],u=h.box(h[n(714)][n(722)],h[n(749)](h[n(714)][n(551)],new Uint8Array([97,118,99,49])),h.box(h[n(714)][n(505)],new Uint8Array([0,0,0,0,...this[n(712)][n(615)][n(636)],0,1,0,0])),h[n(749)](h[n(714)][n(672)],this[n(679)](n(615))));return h[n(749)](h[n(714)].encv,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>>8&255,255&d,l>>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,65,86,67,32,67,111,100,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]),c,u)}esds(e){const n=t;let r=e[n(643)][n(751)],s=new Uint8Array(26+r+3);return s.set([0,0,0,0,3,23+r,0,1,0,4,15+r,64,21,0,0,0,0,0,0,0,0,0,0,0,5,r]),s[n(644)](e.config,26),s[n(644)]([6,1,2],26+r),s}[t(756)](e){const n=t,r=e[n(681)];return h[n(749)](h.types[n(756)],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e[n(567)],0,16,0,0,0,0,r>>>8&255,255&r,0,0]),h[n(749)](h[n(714)][n(589)],this[n(589)](e)))}[t(531)](e){const n=e[t(681)];return new Uint8Array([0,e.channelCount,1,56,0,0,n>>>8&255,255&n,0,0,0])}[t(732)](e){const n=t,r=e[n(681)];return h.box(h[n(714)][n(732)],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e[n(567)],0,16,0,0,0,0,r>>>8&255,255&r,0,0]),h[n(749)](h.types[n(531)],this[n(531)](e)))}[t(483)](e){const n=t,r=h.box(h[n(714)][n(531)],this[n(531)](e)),s=h[n(749)](h[n(714)][n(722)],h[n(749)](h.types[n(551)],new Uint8Array([79,112,117,115])),h[n(749)](h[n(714)][n(505)],new Uint8Array([0,0,0,0,...this[n(712)][n(623)].encryptionScheme,0,1,0,0])),h[n(749)](h.types.schi,this[n(679)](n(623)))),i=e.audiosamplerate;return h[n(749)](h[n(714)].enca,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e[n(567)],0,16,0,0,0,0,i>>>8&255,255&i,0,0]),r,s)}[t(646)](e){const n=t;return"audio"===e[n(593)]?h[n(749)](h.types.stsd,h[n(524)],e[n(512)]?this.enca(e):this[n(732)](e)):h[n(749)](h[n(714)][n(646)],h.STSD,this[n(455)](e))}tkhd(e){const n=t,r=e.id,s=e.duration,i=e.width,o=e.height,a=e[n(761)];return h[n(749)](h[n(714)][n(630)],new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,r>>>24,r>>>16&255,r>>>8&255,255&r,0,0,0,0,s>>>24,s>>>16&255,s>>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,255&a,a%1*10&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>>8&255,255&i,0,0,o>>>8&255,255&o,0,0]))}[t(564)](e,n){const r=t,s=e.id,i=e[r(704)][0][r(580)],o=e[r(704)][0][r(556)],a=e[r(704)][0].flags,c=h[r(749)](h[r(714)].tfhd,new Uint8Array([0,2,0,58,s>>>24,s>>>16&255,s>>>8&255,255&s,0,0,0,1,o>>>24,s>>>16&255,o>>>8&255,255&o,i>>>24,i>>>16&255,i>>>8&255,255&i,0,a[r(451)],0,0])),d=h[r(749)](h[r(714)][r(721)],new Uint8Array([0,0,0,0,n>>>24,n>>>16&255,n>>>8&255,255&n]));if(e.encrypted){let t,n;if(e[r(593)]===r(615)?(t=!0,n=this.drm[r(615)].saiIvSize+8):(t=!1,n=this[r(712)][r(623)][r(651)]),n>0){const s=this[r(720)](n),i=this[r(617)](e[r(704)],t),o=s.length+20+i[r(552)]+c[r(552)]+d[r(552)]+8+16+8+8,a=this[r(558)](e,o);return h.box(h[r(714)][r(564)],c,d,a,s,this[r(747)](o-i[r(552)]+a[r(552)]+8),i)}{const t=this[r(617)](null,!1),n=t[r(552)]+c.length+d[r(552)]+8+16+8+8,s=this.trun(e,n);return h.box(h.types.traf,c,d,s,t)}}return h[r(749)](h[r(714)][r(564)],c,d,this.trun(e,c[r(552)]+d[r(552)]+8+16+8+8))}[t(764)](e){const n=t;return e[n(556)]=e[n(556)]||4294967295,h[n(749)](h[n(714)].trak,this.tkhd(e),this[n(618)](e))}[t(566)](e){const n=t,r=e.id;return h.box(h[n(714)].trex,new Uint8Array([0,0,0,0,r>>>24,r>>>16&255,r>>>8&255,255&r,0,0,0,1,0,0,0,16,0,0,0,0,0,0,0,0]))}[t(558)](e,n){const r=t;let s=(e.samples||[])[r(552)],i=new Uint8Array(12);return n+=20,i.set([0,0,0,1,s>>>24,s>>>16&255,s>>>8&255,255&s,n>>>24,n>>>16&255,n>>>8&255,255&n],0),h[r(749)](h[r(714)].trun,i)}generatePlayReadyHeader(e,n){const r=t,s=r(725),a=r(557),c=o(function(e){const n=t,r=[];return r[n(563)](e[3]),r[n(563)](e[2]),r.push(e[1]),r[n(563)](e[0]),r[n(563)](e[5]),r[n(563)](e[4]),r[n(563)](e[7]),r[n(563)](e[6]),(e=i(e))[n(644)](r,0),e}(e));return i(function(e,n){const r=t,s=new Uint8Array(2*e.length),i=new DataView(s.buffer);for(let t=0;t<e[r(552)];++t){const s=e[r(609)](t);i[r(489)](2*t,s,n)}return s[r(711)]}([r(562)+a+r(596)+s+'">',r(621),"<PROTECTINFO>",r(588),r(462),r(541)+c+'"',">","</KID>","</KIDS>",r(632),n?r(690)+n+r(535):"",r(544),r(542)][r(601)](""),!0))}[t(738)](e){const n=t;if(this.drm[n(745)].startsWith(n(501)))return h[n(749)](h[n(714)][n(738)],new Uint8Array([0,0,0,0,...this[n(712)][n(762)],0,0,0,18,18,16,...this[n(712)][e[0][n(593)]][n(491)]]));if(this[n(712)][n(745)]===n(628)){const t=this.generatePlayReadyHeader(this[n(712)][e[0].type].keyId,this[n(712)][n(532)]),r=t[n(751)];return h[n(749)](h.types[n(738)],new Uint8Array([0,0,0,0,...this.drm[n(762)],r>>>24,r>>>16&255,r>>>8&255,255&r,...t]))}return this.drm[n(745)]===n(676)?h[n(749)](h[n(714)][n(738)],new Uint8Array([1,0,0,0,...this[n(712)].systemID,0,0,0,1,...this[n(712)][e[0].type][n(491)],0,0,0,0])):this.drm[n(745)]===n(665)?null:void console[n(574)]("Unsupported DRM type "+this[n(712)].keySystem)}[t(679)](e){const n=t;return h[n(749)](h[n(714)][n(679)],new Uint8Array([1,0,0,0,0,this[n(712)][e][n(569)],1,this[n(712)][e][n(651)],...this[n(712)][e][n(491)],...this[n(712)][e][n(495)]]))}[t(720)](e){const n=t;return h[n(749)](h[n(714)][n(720)],new Uint8Array([0,0,0,0,e,0,0,0,1]))}saio(e){const n=t;return h.box(h[n(714)][n(747)],new Uint8Array([0,0,0,0,0,0,0,1,e>>>24,e>>>16&255,e>>>8&255,255&e]))}[t(617)](e,n){const r=t;let s=null;return e&&(1!==e[r(552)]&&console[r(574)](r(760)+e[r(552)]+r(550)),s=e[0][r(472)]),s&&s[r(751)]?h[r(749)](h[r(714)].senc,new Uint8Array([0,0,0,n?2:0,0,0,0,1,...s])):h[r(749)](h[r(714)][r(617)],new Uint8Array([0,0,0,0,0,0,0,1]))}initSegment(e,n,r){const s=t,i=this[s(719)](e,n,r);let o=new Uint8Array(h[s(708)][s(751)]+i[s(751)]);return o[s(644)](h[s(708)]),o[s(644)](i,h[s(708)].byteLength),o}}let f=1;class p{constructor(){this.seq=1}static[t(605)](){return f++}[t(525)](){const e=t;this.mp4track[e(746)]=0,this[e(468)][e(704)]=[]}[t(634)](){return!(!this[t(529)]||!this.samples.length)}}function m(e,t){const n=d();return(m=function(e,t){return n[e-=450]})(e,t)}class y extends p{constructor(e){const n=t;super(),this[n(529)]=!0,this[n(471)]=0,this[n(697)]=0,this[n(468)]={id:p[n(605)](),type:n(623),channelCount:2,audiosamplerate:48e3,len:0,fragmented:!0,timescale:e,duration:e,samples:[],codec:"opus",encrypted:!0},this.samples=[]}[t(652)](){this.seq=1,this.nextDts=0,this.dts=0}[t(661)](e,n,r){const s=t;if(e.length>0)for(let t=0;t<e[s(552)];t++){let i=e[t],o=i[s(698)],a=o.byteLength;this[s(704)][s(563)]({units:o,size:a,duration:i[s(556)],sampleAuxInfo:n,timestamp:r}),this.mp4track[s(746)]+=a}}[t(548)](){const e=t;if(!this[e(704)])return null;let n,r=this[e(468)][e(704)];for(;this.samples[e(552)];){let t=this[e(704)][e(546)](),s=(1e3*t.timestamp|0)-this.nextDts|0;s<5&&(s=5),this[e(697)]=this[e(471)],this[e(471)]+=s,n={size:t[e(580)],duration:s,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1},sampleAuxInfo:t[e(472)]};let i=new Uint8Array(t[e(580)]);return i.set(t[e(698)],0),r[e(563)](n),new Uint8Array(i[e(711)],0,t[e(580)])}return null}}class w extends p{constructor(e,n){const r=t;super(),this[r(529)]=!1,this[r(471)]=0,this.dts=0,this.videoElement=n,this[r(468)]={id:p[r(605)](),type:r(615),len:0,fragmented:!0,sps:"",pps:"",width:0,height:0,timescale:e,duration:e,samples:[],encrypted:!0},this[r(704)]=[],this[r(496)]=new l(this)}[t(652)](){const e=t;this[e(510)]=1,this[e(529)]=!1,this[e(468)].sps="",this[e(468)].pps="",this[e(471)]=0,this[e(697)]=0}[t(661)](e,n,r){const s=t;for(let t of e){let e=[],i=0;for(let n of t[s(698)])this[s(496)][s(539)](n)&&(e.push(n),i+=n.getSize());e.length>0&&this[s(529)]&&(this[s(468)][s(746)]+=i,this[s(704)][s(563)]({units:e,size:i,keyFrame:t[s(662)],duration:t.duration,sampleAuxInfo:n,timestamp:r}))}}[t(548)](){const e=t;if(!this[e(634)]()||!this[e(704)])return null;let n,r=this[e(468)].samples,s=this[e(704)][e(546)](),i=s[e(698)],o=(1e3*s[e(635)]|0)-this[e(471)]|0;o<5&&(o=5),window.clRtcDrmDebugLog&&o>5e3&&console[e(575)](e(710)+(o/1e3|0)+" s"),this[e(697)]=this[e(471)],this.nextDts+=o,n={size:s.size,duration:o,cts:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,isNonSync:s[e(662)]?0:1,dependsOn:s.keyFrame?2:1},sampleAuxInfo:s[e(472)]};let a=0;for(const e of i)a+=e.getSize();let c=0,d=new Uint8Array(a);for(const t of i)d[e(644)](t[e(526)](),c),c+=t[e(458)]();return r[e(563)](n),new Uint8Array(d[e(711)],0,a)}}class g extends u{constructor(e,n){const r=t;super(r(597)),this.initialized=!1,this.trackTypes=[],this[r(469)]={},this[r(647)]=1e3,this[r(536)]=0,this[r(727)]=e,this[r(607)]=n}[t(715)](e){const n=t;("video"===e||e===n(624))&&(this[n(469)].video=new w(this.timescale,this[n(727)]),this[n(570)][n(563)](n(615))),("audio"===e||e===n(624))&&(this[n(469)].audio=new y(this.timescale),this.trackTypes.push(n(623)))}reset(){for(let e of this.trackTypes)this.tracks[e].resetTrack();this.initialized=!1}destroy(){const e=t;this[e(469)]={},this[e(622)]()}[t(525)](){const e=t;if(this[e(750)])for(let t of this.trackTypes){let n=this[e(469)][t];for(;;){let s=n.getFramePayload();if(!s||!s[e(751)])break;let i={type:t,payload:r(this[e(607)][e(700)](n.seq++,n[e(697)],n.mp4track),this[e(607)][e(703)](s)),dts:n[e(697)]};this.dispatch(e(711),i),n[e(525)]()}}else this[e(634)]()&&(this.dispatch(e(519)),this[e(508)](),this[e(750)]=!0,this[e(525)]())}initSegment(){const e=t;for(let t of this.trackTypes){let n=this[e(469)][t],r={type:t,payload:this[e(607)][e(508)]([n[e(468)]],this[e(536)],this[e(647)])};this[e(608)](e(711),r)}}isReady(){const e=t;for(let t of this.trackTypes)if(!this[e(469)][t].readyToDecode||!this.tracks[t][e(704)][e(552)])return!1;return!0}[t(661)](e){const n=t;for(let t of this[n(570)]){let r=e[t];if(r[n(552)]>0){this[n(469)][t][n(661)](r,t===n(623)?e[n(639)]:e.videoSampleAuxInfo,e.timestamp)}}this[n(525)]()}}class v extends u{constructor(e,n,r){const s=t;super(s(711)),this[s(593)]=n,this.queue=new Uint8Array,window[s(682)]&&(this[s(606)]=new Uint8Array,this[s(600)]=0),this.sourceBuffer=e,this[s(484)]=r,this[s(657)]=!1,this[s(470)].addEventListener(s(574),(e=>{const t=s;console.warn(t(538),e,this.type),this[t(657)]=!0,this[t(608)]("error",{type:this.type,name:t(711),error:t(613)})}))}[t(707)](){const e=t;this[e(585)]=null,this[e(606)]=null;try{this[e(470)]&&(this[e(470)].abort(),this.mse[e(518)](this[e(470)]),this[e(470)]=null)}catch(e){}this[e(622)]()}[t(737)](){const e=t;if(this[e(585)][e(552)]&&this[e(470)]&&!this[e(470)][e(723)]){if(this[e(470)][e(678)][e(552)]>1){for(let t=0;t<this.sourceBuffer[e(678)].length;++t){const n=t<this.sourceBuffer.buffered[e(552)]-1;window[e(454)]&&console[e(575)](e(583)+t+(n?e(629):"")+": "+this.sourceBuffer[e(678)][e(595)](t)+e(696)+this[e(470)][e(678)].end(t)),n&&this[e(470)][e(654)](this[e(470)].buffered[e(595)](t),this[e(470)][e(678)][e(677)](t))}if(this.sourceBuffer.updating)return}try{this[e(470)].appendBuffer(this.queue),this.queue=new Uint8Array}catch(t){this[e(608)](e(574),{type:this[e(593)],name:e(464),error:t})}}}[t(631)](e){const n=t;if(this[n(606)]&&(this[n(606)]=r(this.dbgQueue,e),100==++this.frameCounter)){const e=(new Date)[n(619)]()[n(477)](0,19)[n(645)](":","-"),t=this[n(593)]+"-"+e+".mp4";window[n(687)](this[n(606)],t),this[n(606)]=null}this[n(657)]||(this[n(585)]=r(this[n(585)],e)),this[n(737)]()}}class b extends u{static isSupported(e){const n=t;return window[n(680)]?window.ManagedMediaSource.isTypeSupported(e):!!window[n(611)]&&window[n(611)][n(475)](e)}constructor(e){const n=t;super(n(695)),this.irrecoverableError=!1,this[n(699)]=!0,this[n(461)]=!1,this.mseReady=!1,this[n(598)]=!1;this.options=Object[n(494)]({},{node:"",mode:"video",debug:!1,onReady:function(){},onError:function(e){}},e),this[n(663)]=typeof this[n(599)][n(663)]===n(702)?document.getElementById(this.options[n(663)]):this[n(599)][n(663)],this[n(712)]=e[n(712)],this[n(607)]=new h(this.drm),this[n(466)]=new g(this[n(663)],this.mp4),this[n(466)][n(715)](this[n(599)].mode),this[n(466)].on(n(711),this[n(658)].bind(this)),this.remuxController.on(n(519),this[n(586)][n(474)](this)),this[n(731)]()}[t(731)](){const e=t;typeof this[e(599)][e(663)]===e(702)&&""==this[e(599)][e(663)]&&console[e(574)](e(579)),this[e(555)]=!1,this[e(616)]()}[t(616)](){const e=t;if(!window[e(680)]&&!window.MediaSource)throw"Failure: Browser doesn't support MSE/MMS";window[e(680)]?(this[e(663)][e(459)]=!0,this[e(590)]=new ManagedMediaSource):this.mediaSource=new MediaSource,this[e(547)]=URL[e(602)](this.mediaSource),this.node[e(673)]=this[e(547)],this[e(598)]=!1,this[e(590)][e(582)](e(734),this[e(674)].bind(this)),this[e(590)].addEventListener(e(581),this.onMSEClose.bind(this)),this[e(590)][e(582)]("webkitsourceopen",this[e(674)].bind(this)),this.mediaSource.addEventListener(e(503),this[e(748)][e(474)](this)),this[e(590)].addEventListener("error",(function(t){const n=e;console[n(574)](n(728),t[n(650)])}))}endMSE(){const e=t;if(!this[e(598)])try{this[e(598)]=!0,this[e(590)].readyState===e(758)&&this[e(590)][e(467)]()}catch(t){console[e(574)](e(724),t)}}[t(642)](){this[t(699)]=!0}[t(631)](e){const r=t;let s={video:[],audio:[]};if(this[r(657)]||this[r(598)])return-1;if(!e||!this[r(466)])return-1;if(e.video){s.timestamp=e[r(635)];const t=this[r(686)](e[r(752)],this[r(712)][r(615)][r(651)]),i=t!=e[r(615)][r(751)];let o=l[r(742)](e[r(615)],i);if(!o.valid||o[r(578)][r(552)]<1)return 0;if(this[r(699)]){if(!o.idr)return 0;this[r(699)]=!1}if(!n&&e[r(752)]){const n=o[r(578)][r(718)](((e,t)=>e+4+t[r(751)]),0);n!==t&&this.patchSampleAuxinfo(e[r(752)],this.drm[r(615)].saiIvSize,n-t)}s[r(615)]=this[r(460)](o[r(578)]),s[r(752)]=e.videoSampleAuxInfo}return e[r(623)]&&(s.timestamp=e[r(635)],s[r(623)]=[{units:e.audio}],s[r(639)]=e[r(639)]),e.video||e[r(623)]?(this[r(466)][r(661)](s),0):(console[r(574)](r(560)),0)}getVideoFrames(e){const n=t;let r=[],s=[],i=!1,o=!1;for(let t of e){let e=new a(t);e.type()!==a[n(709)]&&e.type()!==a[n(637)]||l.parseHeader(e),r[n(552)]&&o&&(e[n(666)]||!e[n(515)])&&(s[n(563)]({units:r,keyFrame:i}),r=[],i=!1,o=!1),r.push(e),i=i||e[n(577)](),o=o||e[n(515)]}if(r[n(552)])if(o)s[n(563)]({units:r,keyFrame:i});else{let e=s[n(552)]-1;e>=0&&(s[e][n(698)]=s[e][n(698)][n(753)](r))}return 1!==s[n(552)]&&console[n(517)](n(509)+s.length),s}calculateExpectedSizeFromSai(e,n){const r=t;if(!e)return 0;const s=(e[0]<<8)+e[1],i=n+2+4;let o=0,a=2;for(;0<s&&a+i<=e[r(751)];){a+=n;const t=(e[a]<<8)+e[a+1],r=(e[a+2]<<24)+(e[a+3]<<16)+(e[a+4]<<8)+e[a+5];a+=6,o+=t+r}return o}[t(506)](e,n,r){const s=t;let i=2;if(0<(e[0]<<8)+e[1]&&i+(n+2+4)<=e[s(751)]){i+=n;let t=(e[i]<<8)+e[i+1];t+=r,t>=0&&(e[i]=t>>>8&255,e[i+1]=255&t)}return 0}createBuffer(){const e=t;if(this[e(555)]&&this[e(466)]&&this[e(466)].isReady()&&!this[e(729)]){this.bufferControllers={};for(let t in this[e(466)][e(469)]){let n=this[e(466)][e(469)][t];const r=""[e(753)](t,e(520))[e(753)](n.mp4track[e(537)],'"');if(window.clRtcDrmDebugLog&&console[e(575)](e(553),r),!b[e(689)](r))return console[e(574)](e(736)),!1;let s=this[e(590)][e(513)](r);this[e(729)][t]=new v(s,t,this[e(590)]),this[e(729)][t].on(e(574),this.onBufferError.bind(this))}}}[t(726)](){const e=t;for(let t in this[e(729)])this[e(729)][t][e(737)]()}[t(658)](e){const n=t;this.mseReady&&this[n(729)]&&this[n(729)][e.type]&&this[n(729)][e[n(593)]][n(631)](e.payload)}[t(674)](){const e=t;window.clRtcDrmDebugLog&&console.info(e(701)),this[e(590)][e(648)]!==e(660)&&(this.mediaSource[e(556)]=Number[e(516)],this[e(555)]=!0,typeof this.options[e(706)]===e(626)&&this[e(599)][e(706)][e(568)](null,this[e(461)]),URL.revokeObjectURL(this[e(547)]),this.createBuffer())}[t(748)](){const e=t;window[e(454)]&&console[e(575)]("[MSE] sourceclose"),this[e(555)]=!1,this[e(543)]()}[t(693)](e){const n=t;console[n(517)](n(545),e),this[n(657)]=!0,this[n(543)](),typeof this.options[n(620)]===n(626)&&this.options[n(620)][n(568)](null,e)}}var S={name:"castlabs-rtc-drm-transform",version:"2.4.0",description:"JS module which allows to play DRM protected RTCPeerConnection video in a HTMLVideoElement",type:"module",main:"rtc-drm-transform.js",scripts:{build:"rollup --config",lint:"eslint src/"},repository:{type:"git",url:"git+ssh://git@github.com/castlabs/cenc-remote-desktop.git"},keywords:["webrtc","insertable-streams","drm","drmtoday","widevine","playready","fairplay","windows","windows-server","macOS","X11","copy-protection","e2e-encryption"],author:"castLabs",license:"ISC",bugs:{url:"https://github.com/castlabs/cenc-remote-desktop/issues"},homepage:"https://github.com/castlabs/cenc-remote-desktop#readme",devDependencies:{"@eslint/js":"^9.11.1","@rollup/plugin-json":"^6.1.0","@rollup/plugin-strip":"^3.0.4","@rollup/plugin-terser":"^0.4.4","@rollup/plugin-typescript":"^12.1.0","@stylistic/eslint-plugin":"^2.8.0","@types/eslint__js":"^8.42.3",eslint:"^9.11.1","javascript-obfuscator":"^4.1.1",rollup:"^4.22.4","rollup-plugin-delete":"^2.1.0","rollup-plugin-dts":"^6.1.1","rollup-plugin-obfuscator":"^1.1.0",typescript:"^5.6.2","typescript-eslint":"^8.7.0"}};!function(){const e=I,t=A();for(;;)try{if(324070===-parseInt(e(468))/1+parseInt(e(469))/2+-parseInt(e(474))/3*(parseInt(e(476))/4)+-parseInt(e(470))/5+-parseInt(e(479))/6*(-parseInt(e(475))/7)+-parseInt(e(473))/8+parseInt(e(478))/9)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const U=()=>{const e=I;let t=e(472)+(new Date)[e(471)]();return S&&(t=S[e(477)]),t};function I(e,t){const n=A();return(I=function(e,t){return n[e-=468]})(e,t)}function A(){const e=["2247530sqDpfe","toISOString","__dev_time__","5141376xRhrDH","3dIbGPs","1220569KoCmNv","2523628bGkRGg","gitVersion","9626760ldyaKP","18zktfyS","134350ptEqvk","1177528NltpdS"];return(A=function(){return e})()}function E(){const e=["V382D1oJAM0F/YgCQtNDLz7vTWJ+QskNGi5Dd2qzO4s48Cnx5BLvL4H0xCRSw2Ed6ekHSdrRU","atob","Development","30QEHzUN","Staging","https://lic.test.drmtoday.com","name","Production","+vwmV2/NJWxKqHBKdL9JqvOnNiQUF0hDI7Wf8Wb63RYSXKE27Ky31hKgx1wuq7TTWkA+kHnJT","27eI5MATX39gYtCnn7dDXVxo4/rCYK0A4VemC3HRai2X3pSGcsKY7+6we7h4IycjqtuGtYg8A","xUuwokpsqVIHZrJfu62ar+BF8UVUKdK5oYQoiTZd9OzK3kr29kqGGk3lSgM0/p499p/FUL8oH","4865XQMADs","160538lOHMNt","91842oBcfpa","baseUrl","https://lic.staging.drmtoday.com","staging","308KLlRjJ","7hyskG5ZLAyJMzTvgnV3D8/I5Y6mCFBPb/+/Ri+9bEvquPF3Ff9ip3yEHu9mcQeEYCeGe9zR/","2698soaNGA","certificate","2603512BsHriy","wyoYOE+M/t1oIbccwlTQ7o+BpV1X6TB7fxFyx1jsBtRsBWphU65w121zqmSiwzZzJ4xsXVQCJ","development","RL9KsD0v7ysBQVdUXEbJotcFz71tI5qc3jwr6GjYIPA3VzusD17PN6AGQniMwxJV12z/EgnUo","production","4341535HUMKmM","pQnNI61gzHO42XZOMuxytMm0F6puNHTTqhyY3Z290YqvSDdOB+UY5QJuXJgjhvOUD9+oaLlvT","532JOmVLc","2113245bMrvgc","18VNRfWD","baigovcoURAZcr1d/G0rpREjLdVLG0Gjqk63Gx688W5gh3TKemsK3R1jV0dOfj3e6uV/kTpsN"];return(E=function(){return e})()}function k(e,t){const n=E();return(k=function(e,t){return n[e-=431]})(e,t)}const D=k;!function(){const e=k,t=E();for(;;)try{if(357104===parseInt(e(434))/1+-parseInt(e(459))/2+parseInt(e(444))/3+parseInt(e(443))/4*(-parseInt(e(458))/5)+parseInt(e(460))/6*(-parseInt(e(432))/7)+parseInt(e(436))/8*(-parseInt(e(445))/9)+-parseInt(e(450))/10*(-parseInt(e(441))/11))break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const T="CrsCCAMSEKDc0WAwLAQT1SB2ogyBJEwYv4Tx7gUijgIwggEKAoIBAQC8Xc/GTRwZDtlnBThq8"+D(447)+D(437)+D(442)+D(455)+"UrTEfQxfPR4dJTquE+IDLAi5yeVVxzbAgMBAAE6DGNhc3RsYWJzLmNvbUABEoADMmGXpXg/0q"+D(457)+"HzgsJ7Hajdsyzn0Vs3+VysAgaJAkXZ+k+N6Ka0WBiZlCtcunVJDiHQbz1sF9GvcePUUi2fM/h"+D(433)+D(456)+D(446)+D(439)+"pcFB13osydpD2AaDsgWo5RWJcNf+fzCgtUQx/0Au9+xVm5LQBdv8Ja4f2oiHN3dw",R=Uint8Array.from(window[D(448)](T),(e=>e.charCodeAt(0)));class M{constructor(e){this[D(453)]=e}toString(){return this[D(453)]}[D(461)](){const e=D;switch(this[e(453)]){case e(431):return e(462);case e(438):return e(452);default:return"https://lic.drmtoday.com"}}[D(435)](){return R}}function x(){const e=["getUint8","6120990upmYVH","Unsupported SampleAuxInfo version","6681904bUZfYM","1026114stCTGm","12896056wVeSIV","2967096INydVk","20KAUTTd","SampleAuxInfo corrupted","5471973chYjQW","buffer","cenc","SampleAuxInfo corrupted (postfix not found)","error","data","getUint16","7jdHIFn","334oDWPye","5737LRtSrK"];return(x=function(){return e})()}function L(e,t){const n=x();return(L=function(e,t){return n[e-=215]})(e,t)}function C(e,t){const n=H();return(C=function(e,t){return n[e-=272]})(e,t)}M[D(451)]=new M(D(431)),M[D(454)]=new M(D(440)),M[D(449)]=new M(D(438)),function(){const e=L,t=x();for(;;)try{if(872274===parseInt(e(216))/1*(parseInt(e(215))/2)+parseInt(e(221))/3+parseInt(e(220))/4+parseInt(e(218))/5+-parseInt(e(223))/6+-parseInt(e(233))/7*(parseInt(e(222))/8)+-parseInt(e(226))/9*(parseInt(e(224))/10))break;t.push(t.shift())}catch(e){t.push(t.shift())}}(),function(){const e=C,t=H();for(;;)try{if(986931===-parseInt(e(272))/1*(-parseInt(e(279))/2)+parseInt(e(278))/3*(-parseInt(e(273))/4)+parseInt(e(286))/5*(-parseInt(e(274))/6)+-parseInt(e(285))/7+-parseInt(e(277))/8+-parseInt(e(280))/9*(parseInt(e(275))/10)+parseInt(e(281))/11)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const F=[];let B=null,N=0;function P(e){return!B&&function(){const e=C;B=new Uint8Array([0,0,0,1,65,154,255,255])[e(282)],F[e(283)](new Uint8Array([0,0,0,1,39,100,0,13,172,87,5,6,100,0,0,0,1,40,238,60,176,0,0,0,1,37,184,32,0,203,255,38,29,217,24,192,161,96,0,0,12,229,174,166,6,7,20,3,84,0,247,96,193,181,229,128,0,32,32]).buffer),F[e(283)](F[0][e(284)](0)),new Uint8Array(F[1])[e(276)]([16,0,50],27)}(),e?B:(N^=1,F[N])}function H(){const e=["slice","5566064tgmsuD","1243390MaHRPo","7646sSujuI","35692bVMoZZ","6ObHRvK","1956830RCxgWp","set","588328HgIwqU","438iAdZRm","4nTLwDZ","54xPzQSc","50224526zsMUCK","buffer","push"];return(H=function(){return e})()}function O(){const e=["kids","559202yiHLhN","info","parseFromString","No init data available!","nodeValue","9a04f07998404286ab92e65be0885f95","961005xHVHlu","[EME]","close","Data has an incorrect length, must be even.","833396owpUFh","Failed to reuse previous EME session: ","persistent-license","Key ","push","buffer","vendor","encode","then","rtcdrmerror","internal-error","load","324912fiIbxM","update","edef8ba979d64acea3c827dcd51d21ed","delete","apply","set","append","max","Apple","Challenge","getElementsByTagName","arrayBuffer","floor","Failed to update the session","status","bind","No PR challenge data!","Data does not seem to be UTF-16 encoded!","replace","No media element available!","BYTES_PER_ELEMENT","No clear key test key provided!","[FPS] License fetched:","fromCharCode","Content-Type","Failed to update the session: ","mediaKeys","atob","byteLength","[PR] License fetched:","217135Eimdcp","expired","3464OUovjJ","getUint16","[PR] Challenge node not found","730116PYhMTN","keyStatuses","indexOf","message","text/xml","license","initData","json","13629gXuraF","Failed to load previous EME session","oct","output-restricted","error","warn","No media keys for media element!","temporary","New lic will be requested","CDM error generating license request: ","log","addEventListener","includes","clRtcDrmDebugLog","licenseUrl","License acquisition failed with error ","target","childNodes","dispatchEvent","onFetch","usable for decryption (status: ","stringify","catch","length","btoa","initDataType","subarray"," is not ","text","min","decode","POST","parse","keystatuseschange","get","A128KW","createSession"];return(O=function(){return e})()}const z=W;!function(){const e=W,t=O();for(;;)try{if(140947===-parseInt(e(262))/1+-parseInt(e(210))/2+-parseInt(e(267))/3+-parseInt(e(220))/4+parseInt(e(216))/5+parseInt(e(232))/6+-parseInt(e(275))/7*(-parseInt(e(264))/8))break;t.push(t.shift())}catch(e){t.push(t.shift())}}();let K={licenseUrl:"",onFetch:void 0};const V={},q=(e,t,n)=>{const r=W,s=Uint8Array[r(252)];t*=s,n*=s;const i=(c=e)instanceof ArrayBuffer?c:c[W(225)],o=e[r(260)],a=t;var c;let d=Math[r(239)](0,Math[r(304)](a,o)),l=Math.min(d+Math[r(239)](n,0),o);return d/=s,l/=s,new Uint8Array(i,d,l-d)},j=(e,t=0,n=1/0)=>q(e,t,n);function W(e,t){const n=O();return(W=function(e,t){return n[e-=203]})(e,t)}function G(e,t,n=!1){const r=W;if(!e)return"";let s=e;if(!n&&s[r(260)]%2!=0)throw console[r(279)](r(219)),new Error(r(249));const i=j(s);let o;if((t&&255===i[0]&&254===i[1]||254===i[0]&&255===i[1])&&(s=i[r(301)](2)),s instanceof ArrayBuffer)o=s;else{const e=new Uint8Array(s[r(260)]);e[r(237)](j(s)),o=e.buffer}const a=Math[r(244)](s[r(260)]/2),c=new Uint16Array(a),d=new DataView(o);for(let e=0;e<a;e++)c[e]=d[r(265)](2*e,t);return function(e){const t=W;let n="";for(let r=0;r<e.length;r+=16e3){const s=e[t(301)](r,r+16e3);n+=String[t(255)][t(236)](null,s)}return n}(c)}const Y=e=>{let t="";for(const n of e){let e=n.toString(16);1==e.length&&(e="0"+e),t+=e}return t};let J=null;const _=e=>{const t=W;return window[t(299)](String[t(255)][t(236)](null,e))[t(250)](/\+/g,"-")[t(250)](/\//g,"_")[t(250)](/=*$/,"")},Q=(e,t)=>{const n=W,r=(e=>{const t=W,n=JSON[t(204)]((new TextDecoder)[t(305)](e));if(console[t(285)]("CK license request:",n),null===J)throw new Error(t(253));const r=[];for(const e of n[t(209)]){const n={kty:t(277),alg:t(207),kid:e,k:_(J)};r[t(224)](n)}return(new TextEncoder)[t(227)](JSON[t(296)]({keys:r}))})(t.message);t[n(291)][n(233)](r)[n(297)]((function(e){const t=n;console[t(279)](t(245),e)}))},Z=e=>{const t=W,n=window[t(259)](e[t(250)](/-/g,"+").replace(/_/g,"/")),r=new Uint8Array(n[t(298)]);for(let e=0;e<n[t(298)];++e)r[e]=n.charCodeAt(e);return r},X=(t,n,...r)=>e(void 0,[t,n,...r],void 0,(function*(e,t,n=!1){const r=W,s=new Headers(V);n&&s[r(238)](r(256),r(271));const i={method:r(203),headers:s,body:t},o=yield K[r(294)]?K[r(294)](e,i):fetch(e,i);if(!o.ok)throw new Error(r(290)+o[r(246)]);return o})),$=(e,t)=>{const n=W;X(K[n(289)],t[n(270)])[n(228)]((e=>e[n(274)]()))[n(228)]((e=>{const r=n;window.clRtcDrmDebugLog&&console.info("[WV] License fetched:",e.license);const s=Z(e[r(272)])[r(225)];t[r(291)].update(s)[r(297)]((e=>{console.error("Failed to update the session",e)}))}))[n(297)]((t=>{const r=n;e[r(293)](new CustomEvent("rtcdrmerror",{detail:{message:""+t}})),console[r(279)](t)}))},ee=(e,t)=>{const n=W,r=((e,t)=>{const n=W,r=new DOMParser;try{const e=G(t,!0);if(e[n(269)]("<Challenge")>-1){const t=r[n(212)](e,"text/xml")[n(242)](n(241))[0][n(292)][0][n(214)];if(null===t)throw new Error(n(248));return Z(t)}console[n(280)](n(266))}catch(t){e.dispatchEvent(new CustomEvent("rtcdrmerror",{detail:{message:""+t}})),console[n(279)](t)}return null})(e,t[n(270)]);if(null===r)return e[n(293)](new CustomEvent("rtcdrmerror",{detail:{message:n(248)}})),void console[n(279)](n(248));X(K.licenseUrl,r[n(225)],!0)[n(228)]((e=>e[n(243)]()))[n(228)]((r=>{const s=n;window[s(288)]&&console[s(211)](s(261),r);t[s(291)][s(233)](r)[s(297)]((function(t){const n=s;e.dispatchEvent(new CustomEvent(n(229),{detail:{message:n(257)+t}})),console[n(279)](n(245),t)}))}))[n(297)]((t=>{const r=n;e[r(293)](new CustomEvent(r(229),{detail:{message:""+t}})),console.error(t)}))},te=(e,t)=>{const n=W;X(K.licenseUrl,t[n(270)]).then((e=>{const t=n,r=e[t(303)]();return window.clRtcDrmDebugLog&&console[t(211)](t(254),e,r),r}))[n(228)]((e=>{const r=n;t[r(291)][r(233)](Z(e))})).catch((t=>{const r=n;e.dispatchEvent(new CustomEvent(r(229),{detail:{message:""+t}})),console[r(279)](t)}))},ne=(e,t)=>{V[e]=t},re=navigator[z(226)]&&navigator[z(226)][z(287)](z(240));let se=!re;const ie=new Map;function oe(t){return e(this,void 0,void 0,(function*(){const e=W;if(null===t[e(273)])throw new Error(e(213));const n=t[e(291)];if(null===n)throw new Error(e(251));const r=n[e(258)];if(null===r)throw new Error(e(281));const s=Y(new Uint8Array(t.initData)),i=s+n.id;let o=null;ie.has(i)&&(o=ie[e(206)](i),null!=o&&o[e(218)](),ie[e(235)](i)),window[e(288)]&&console[e(211)](e(217),o?"Previous lic will be reused":e(283));let a=null;try{a=r[e(208)](se?e(222):"temporary")}catch(t){console[e(285)]("EME createSession(persistent) failed:",t)}if(!a&&se){se=!1;try{a=r[e(208)](e(282))}catch(t){console[e(279)]("EME createSession(temporary) failed:",t)}}if(a)if(a[e(286)](e(205),(t=>{const n=e;t[n(291)][n(268)].forEach(((e,t)=>{const r=n;(e===r(263)||e===r(278)||"output-downscaled"===e||e===r(230))&&a[r(293)](new CustomEvent(r(229),{detail:{message:r(223)+Y(new Uint8Array(t))+r(302)+(r(295)+e+")"),keyId:t}}))}))})),re?a[e(286)](e(270),te.bind(null,n),!1):-1!==s[e(269)](e(234))?a.addEventListener("message",$[e(247)](null,n),!1):-1!==s[e(269)](e(215))?a.addEventListener(e(270),ee.bind(null,n),!1):a[e(286)](e(270),Q[e(247)](null,n),!1),o)try{(yield a[e(231)](o.sessionId))?ie[e(237)](i,a):n.dispatchEvent(new CustomEvent("rtcdrmerror",{detail:{message:e(276)}}))}catch(t){n[e(293)](new CustomEvent(e(229),{detail:{message:e(221)+t}}))}else a.generateRequest(t[e(300)],t[e(273)])[e(228)]((()=>{se&&ie.set(i,a)})).catch((t=>{const r=e;n[r(293)](new CustomEvent(r(229),{detail:{message:r(284)+t}}))}));else n[e(293)](new CustomEvent(e(229),{detail:{message:"EME createSession() failed - no DRM available"}}))}))}const ae=Me;var ce,de,le;!function(){const e=Me,t=Ne();for(;;)try{if(923360===-parseInt(e(443))/1+-parseInt(e(346))/2*(-parseInt(e(241))/3)+parseInt(e(243))/4*(-parseInt(e(393))/5)+parseInt(e(453))/6*(parseInt(e(297))/7)+parseInt(e(447))/8*(-parseInt(e(417))/9)+-parseInt(e(452))/10*(-parseInt(e(481))/11)+-parseInt(e(290))/12)break;t.push(t.shift())}catch(e){t.push(t.shift())}}();const ue=!!window.RTCRtpScriptTransform,he=navigator[ae(300)][ae(276)]("Firefox"),fe=!he&&navigator[ae(459)][ae(276)]("Apple"),pe=!he&&!fe&&window.navigator[ae(300)].includes(ae(302)),me=!he&&!fe&&!pe&&window[ae(259)].userAgent[ae(276)](ae(446)),ye=(null===(de=null===(ce=null===window||void 0===window?void 0:window[ae(259)])||void 0===ce?void 0:ce.userAgentData)||void 0===de?void 0:de[ae(252)])||(null===(le=null===window||void 0===window?void 0:window[ae(259)])||void 0===le?void 0:le.platform),we=ye===ae(282),ge=pe||me&&ye===ae(288),ve=1e6*(he?82:fe?220:120),be=he?5e3:2e3,Se=he?1.5:.5;class Ue{constructor(e){const t=ae;this[t(409)]=[],this[t(258)]="",this[t(426)]="",this[t(416)]="",this.jmuxer=null,this[t(341)]=-1,this.keyFrameLogCntr=0,this[t(479)]=Date.now(),this[t(264)]=0,this[t(380)]=0,this[t(326)]=-1,this.lastKeyFrameTime=0,this[t(441)]=0,this.keyFrameNeeded=!0,this.keyFrameNeededPosted=!1,this[t(322)]=be,this[t(240)]=null,this.video=e.video,this.audio=e[t(274)],this[t(371)]=e.merchant,this.environment=e.environment,this[t(438)]=e[t(438)],this[t(381)]=e[t(381)],this.customTransform=e.customTransform,this[t(298)]=e[t(298)],this[t(338)]=e[t(338)],this[t(377)]=e[t(377)],this[t(242)]=e[t(242)],this.sessionId=e[t(266)],this[t(419)]=e[t(419)],this[t(456)]=e.wvCertificateUrl,this[t(263)]=e.wvLicenseUrl,this.prLicenseUrl=e[t(437)],this[t(334)]=e[t(334)],this[t(404)]=e[t(404)],this.fpsLicenseUrl=e[t(365)]}}const Ie=new Map,Ae=new Uint8Array([60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60]),Ee=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]),ke=new Uint8Array([213,251,214,184,46,217,62,78,249,138,228,9,49,238,51,183]);function De(e,t){const n=ae;void 0!==t&&(e.mediaBufferMs=t),(void 0===e.mediaBufferMs||e.mediaBufferMs<0)&&(e[n(341)]=100,he?e[n(341)]=350:!fe&&we&&(e[n(338)]===n(463)||e[n(325)])&&(e[n(341)]=1400))}function Te(e){const t=ae;let n=!1;if((e[t(375)]&&"clear"!==e[t(375)][t(315)]&&"HW"===e[t(375)][t(435)]||e[t(274)]&&"clear"!==e[t(274)][t(315)]&&"HW"===e.audio[t(435)])&&(n=!0),e[t(325)]=n,De(e,e[t(341)]),void 0===e.authToken){void 0===e[t(242)]&&(e[t(242)]=t(355)),void 0===e[t(266)]&&(e.sessionId=t(281));const n=window.btoa(JSON[t(464)]({userId:e[t(242)],sessionId:e[t(266)],merchant:e[t(371)]}));ne(t(445),n)}else ne(t(428),e[t(377)]);for(const n of[e[t(274)],e[t(375)]])n&&n[t(315)]!==t(287)&&(!n[t(457)]&&(n[t(457)]=Ee),!n.iv&&(n.iv=ke),n[t(315)]===t(278)?(n[t(444)]=new Uint8Array([99,98,99,115]),n[t(398)]=new Uint8Array([16,...n.iv]),n[t(329)]=25,n[t(272)]=0):(n[t(444)]=new Uint8Array([99,101,110,99]),n[t(398)]=new Uint8Array([]),n[t(329)]=0,n.saiIvSize=16));e.serverCertificate=void 0,e[t(258)]="",e[t(426)]="";const r=e[t(307)][t(339)]();var s;if(e[t(338)]===t(336)?(e[t(416)]=t(291),e.systemID=new Uint8Array([16,119,239,236,192,178,77,2,172,227,60,30,82,226,251,75]),J=Ae):e[t(338)]===t(358)?(e[t(416)]=t(275),we&&n&&(e[t(416)]+=t(335)),e.systemID=new Uint8Array([237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237]),e[t(419)]?e[t(296)]=e[t(419)]:e[t(456)]?e[t(258)]=e[t(456)]:e[t(296)]=e.environment[t(261)](),e.wvLicenseUrl?e[t(426)]=e[t(263)]:e.licenseUrl=r+t(430)):e.type===t(463)?(e[t(416)]=t(406),e[t(285)]=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),e[t(437)]?e.licenseUrl=e.prLicenseUrl:e[t(426)]=r+t(388)):e[t(338)]===t(385)&&(e[t(416)]=t(292),e[t(285)]=void 0,e.fpsCertificate?e[t(296)]=e[t(334)]:e[t(404)]?e[t(258)]=e[t(404)]:e[t(258)]=r+t(387)+e[t(371)],e.fpsLicenseUrl?e.licenseUrl=e[t(365)]:e[t(426)]=r+"/license-server-fairplay/"),s={licenseUrl:e[t(426)],onFetch:e[t(298)]},K=s,e.emeConfig=[],e[t(338)]!==t(385)){e[t(409)][t(324)]({initDataTypes:["cenc"],sessionTypes:[t(255),t(422)]});for(const n of[e.video,e[t(274)]])if(n&&n[t(315)]!==t(287)){const r=n==e.video?t(375):"audio";let s;e[t(338)]===t(358)?s="HW"===n.robustness?t(349):t(362):e.type===t(463)&&(s="HW"===n[t(435)]?"3000":t(280)),"video"===r?e[t(409)][0][t(405)]=[{contentType:t(309),encryptionScheme:n[t(315)]===t(429)?t(429):t(473),robustness:s||void 0}]:e.emeConfig[0].audioCapabilities=[{contentType:t(301),encryptionScheme:n.encryption===t(429)?"cenc":"cbcs-1-9",robustness:s||void 0}]}}else e[t(409)]=[{initDataTypes:[t(449)],videoCapabilities:[{contentType:"video/mp4",robustness:""}],distinctiveIdentifier:"not-allowed",persistentState:t(395),sessionTypes:[t(422)]}];window[t(410)]&&console[t(330)]("DRM config:",e)}function Re(e){const t=ae;window.clRtcDrmDebugLog&&console[t(330)](t(283));let n=e.videoElement;(!e[t(375)]||e[t(375)][t(315)]===t(287))&&(n=e[t(381)]),e[t(244)]=null;const r=!e[t(356)]&&e[t(274)]&&"clear"!==e.audio[t(315)],s=e[t(375)]&&e.video[t(315)]!==t(287);e[t(441)]=0,e[t(368)]=!0,e[t(308)]=!1,e[t(322)]=be,e[t(264)]=0,e[t(380)]=0,e[t(326)]=-1,e[t(289)]=0,e[t(244)]=new b({node:n,mode:r?t(s?286:274):"video",fps:60,drm:e}),fe&&e[t(438)]&&e[t(438)].play().then((()=>{}))[t(253)]((()=>{}))}function Me(e,t){const n=Ne();return(Me=function(e,t){return n[e-=240]})(e,t)}function xe(e,t){const n=ae;0===e[n(264)]&&(e.videoStartTimestamp=t[n(284)],e[n(322)]=be,e[n(479)]=Date[n(475)]()+2e3);let r=null,s=!1;if(t[n(369)][n(354)]<=4)console[n(476)](n(270)),s=!0;else{const i=new Uint8Array(t[n(369)],0,4);0!=i[0]||0!=i[1]||0!=i[2]||1!=i[3]?(console[n(476)](n(403)),s=!0):(r=function(e,t){const n=L,r=new DataView(e[n(231)]),s=e[n(231)].byteLength-2,i=r[n(232)](s);if(i<s){let e=s-i;if(69!==r[n(217)](s-1))return console[n(230)](n(229)),null;const o=1;if(r[n(217)](e++)>>>4!==o)return console.error(n(219)),null;const a=new Uint8Array(i-2);let c=0,d=0;for(;e<s-1;){let t=r[n(217)](e++);d>1&&3===t&&(d=0,t=r[n(217)](e++)),0!==t?d=0:++d,a[c++]=t}const l=new DataView(a[n(227)]),u=t===n(228)?16:0,h=u+2+6*l[n(232)](u);return h+2>c?(console[n(230)](n(225)),null):{sai:a.subarray(0,h),offset:s-i,seq:l[n(232)](h)}}return null}(t,e[n(375)][n(315)]),!r&&(console[n(476)](n(448)),s=!0))}if(r)if(-1===e[n(326)]){if(t.type!==n(378))return 0;e[n(326)]=r[n(461)]}else{const i=65535;let o=r.seq-e[n(326)];if(o<-(i>>1)&&(o+=i+1),o<=0)return window[n(410)]&&console[n(476)]("Duplicate/reordered frame, prev seq: "+e.prevSeqNum+n(413)+r[n(461)]),0;o>1&&(s="key"!==t.type,console[n(476)](n(471)+e[n(326)]+n(344)+r.seq+", restart required: "+s)),e.prevSeqNum=r[n(461)]}let i=0;s&&!e[n(244)].waitingForIdr&&(i=-1,e[n(244)][n(265)]());const o=(t[n(284)]-e[n(264)])/9e4;return r&&e[n(244)][n(314)]({video:new Uint8Array(t[n(369)],0,r[n(295)]),videoSampleAuxInfo:r[n(303)],timestamp:o})<0&&(i=-1,console.warn(n(389)),Re(e)),i>=0&&t[n(338)]===n(378)&&(e[n(289)]=o,console[n(357)]((new Date)[n(474)]()[n(246)](11,-1)+n(420)+o+n(352)+e[n(438)][n(331)])),i}function Le(e){const t=ae;if(!e[t(438)]||e[t(438)][t(458)][t(267)]<1||e[t(438)].paused||e[t(438)][t(331)]<Se)return;const n=e[t(438)][t(458)][t(268)](e[t(438)][t(458)][t(267)]-1),r=1e3*(n-e[t(438)].currentTime)|0;if(!e.audioEncrypted&&function(e,t){const n=ae,r=e.videoElement[n(480)];let s;s=t<3*e.mediaBufferMs>>>2?.875:t<=e.mediaBufferMs?1:t<7*e[n(341)]>>>2?1.125:t<9*e[n(341)]>>>2?1.25:t<11*e.mediaBufferMs>>>2?1.375:1.5,s!==r&&(e[n(438)][n(480)]=s)}(e,r),!(r<e[t(341)]+50||r<5*e.mediaBufferMs>>>2))if(e.lastKeyFrameTime>e[t(438)][t(331)]+.1){const r=1e3*(n-e[t(289)])|0;r>40&&r>e.mediaBufferMs-100?(window.clRtcDrmDebugLog&&console.info((new Date)[t(474)]()[t(246)](11,-1)+t(310)+(e[t(438)][t(331)]+t(347)+e[t(289)]+" (")+(e.lastKeyFrameTime-e.videoElement[t(331)])+")"),e[t(438)][t(331)]=e.lastKeyFrameTime):console[t(357)]((new Date)[t(474)]()[t(246)](11,-1)+" too close to seek, "+r)}else!e[t(368)]&&Date[t(475)]()>e[t(479)]&&r>e[t(341)]+100&&r>3*e[t(341)]>>>1&&(window.clRtcDrmDebugLog&&console[t(330)]((new Date)[t(474)]()[t(246)](11,-1)+t(374)+r+t(396)),e.keyFrameNeeded=!0,e[t(322)]<16e3&&(e[t(322)]<<=1))}function Ce(e,t){const n=ae;var r;if(!e[n(244)]||e[n(356)])return 0;0===e[n(380)]&&(e[n(380)]=t[n(284)]);const s=(t[n(284)]-e[n(380)])/48e3;if((null===(r=e[n(274)])||void 0===r?void 0:r[n(315)])===n(278))return e.jmuxer[n(314)]({audio:new Uint8Array(t[n(369)]),timestamp:s});const i=function(e){const t=L,n=new DataView(e[t(231)]),r=e[t(231)].byteLength-2,s=n[t(232)](r);if(s<r){let e=r-s;if(69!==n[t(217)](r-1))return console[t(230)]("SampleAuxInfo corrupted (postfix not found)"),null;const i=1;if(n[t(217)](e++)>>>4!==i)return console[t(230)](t(219)),null;const o=new Uint8Array(s-2);let a=0;for(;e<r-1;){const t=n.getUint8(e++);if(o[a++]=t,a>=16)break}return{sai:o,offset:r-s}}return null}(t);return i?e[n(244)][n(314)]({audio:new Uint8Array(t[n(369)],0,i[n(295)]),audioSampleAuxInfo:i[n(303)],timestamp:s}):(console.error("SampleAuxInfo extraction failed (audio)"),-1)}function Fe(e,t,n){const r=Ke(n);return e.type?Be(r,e,t):Pe(r,e,t)}function Be(e,t,n){const r=ae;if(e[r(375)]&&e.video[r(315)]===r(287))return null==n||n[r(269)](t),!1;const s=Date[r(475)]();if("key"===t[r(338)]){const n=window[r(410)];++e[r(423)]<(n?Number.POSITIVE_INFINITY:5)&&(console[r(330)]((new Date).toISOString()[r(246)](11,-1)+" "+t[r(338)]+", "+(t[r(369)][r(354)]+r(424)+e[r(438)].currentTime)),n&&1===e[r(423)]&&function(e,t=64,n=64){const r=ae,s=new Uint8Array(e[r(369)]);let i="",o=0;for(let e=0;e<t&&e<s.length;++e)i+=(s[e]<16?"0":"")+s[e][r(397)](16)+" ";if(o<s[r(267)])for(o<s.length-n&&(i+=r(350),o=s[r(267)]-n);o<s[r(267)];o++)i+=(s[o]<16?"0":"")+s[o][r(397)](16)+" ";console[r(330)]("["+((e.type||r(274))+r(342))+r(343)+i[r(425)]())}(t,128,8)),e[r(368)]=!1,e[r(441)]=0,e[r(479)]=s+e[r(322)]}return e[r(441)]+=t[r(369)].byteLength,!e.keyFrameNeeded&&e[r(441)]>ve&&(console[r(330)](r(299)),e[r(368)]=!0),e[r(244)]&&(xe(e,t)<0?e.keyFrameNeeded=!0:Le(e)),n?(!e[r(368)]||!ge)&&(t.data=P(e[r(368)]),n[r(269)](t)):e[r(368)]!=e.keyFrameNeededPosted&&(e[r(240)]&&e[r(240)][r(340)](e.keyFrameNeeded),e.keyFrameNeededPosted=e[r(368)]),e.keyFrameNeeded}function Ne(){const e=["onFetch","GOP is getting too long, requesting a new key frame","userAgent",'audio/mp4; codecs="opus"',"Edg","sai",") not found in [","rtcDrmConfigure did not specify audioElement, audio will be dropped","Fetched certificate from ","environment","keyFrameNeededPosted",'video/mp4; codecs="avc1.640032"'," seeking from ","ClearKey is not supported by Safari.","let brokenFrame=null,idrFrames=[];function initializeDummyFrames(){brokenFrame=new Uint8Array([0,0,0,1,65,154,255","sessionTypes","feed","encryption","mediaBufferMs should be an integer.","URL","srcObject","kind","DRM config keyId must be an instance of 16-byte long Uint8Array.","next","keyFrameRequestInterval","GET","push","hwSecurity","prevSeqNum","Invalid authToken type (","Worker","cryptPattern","info","currentTime","pipeThrough","message","fpsCertificate",".experiment","ClearKey",'rame:{type:$.type,timestamp:$.timestamp,data:$.data}}),"key"===$.type&&(keyFrameNeeded=!1),$.data=generateDummyFr',"type","baseUrl","postMessage","mediaBufferMs"," frame","]: "," - ","play","430YHxZPA"," to ","?audioTransformFunction:videoTransformFunction});e.pipeThrough(a).pipeTo(x)}self.RTCTransformEvent&&(self.onrtctr","HW_SECURE_ALL",".. ","dispatchEvent",", playback at ","splice","byteLength","purchase","ignoreAudio","log","Widevine","DRM config env value must be one of: ","encrypted","frame","SW_SECURE_CRYPTO","Development","DRM config iv must be an instance of 16-byte long Uint8Array.","fpsLicenseUrl","). Safari only supports FairPlay.","). Edge only supports PlayReady, Widevine and ClearKey.","keyFrameNeeded","data","No target media element!","merchant","No valid DRM config found, call rtcDrmConfigure first.","requestMediaKeySystemAccess"," requesting a new key frame (latency ","video","ansform=$=>{let e=$.transformer;handleTransform(e.options.operation,e.readable,e.writable)}),onmessage=$=>{keyFra","authToken","key","requestMediaKeySystemAccess(","audioStartTimestamp","audioElement","join",'ame(keyFrameNeeded),e.enqueue($)}function handleTransform($,e,x){let a=new TransformStream({transform:"audio"===$',"jitterBufferTarget","FairPlay","clRtcDrmCreateMediaDump","/license-server-fairplay/cert/","/license-proxy-headerauth/drmtoday/RightsManager.asmx","Error recovery attempted","setMediaKeys","error","),idrFrames.push(idrFrames[0].slice());let $=new Uint8Array(idrFrames[1]);$.set([16,0,50],27)}let idrPicIdToggle=","5Xrtatp",'data}}),e.enqueue($)}let keyFrameNeeded=!1;function videoTransformFunction($,e){postMessage({streamType:"video",f',"not-allowed"," ms)","toString","tencIvRecord","createObjectURL",") failed","Blob","createMediaKeys(","Discarding corrupted video frame (no Annex B startcode)","fpsCertificateUrl","videoCapabilities","com.microsoft.playready.recommendation","Invalid DRM type (","RTCRtpScriptTransform/TransformStream will not be created, ","emeConfig","clRtcDrmDebugLog","get","Invalid audioElement, it must be an instance of HTMLMediaElement.",", curr: ","transform","createEncodedStreams","keySystem","2628Wkqzhb","Invalid config argument type, DRM config must be an object.","wvCertificate"," kf at ","DRM config encryption value must be one of: ","temporary","keyFrameLogCntr"," bytes, playback at ","trim","licenseUrl","debugCreateMediaDump","x-dt-auth-token","cenc","/license-proxy-widevine/cenc/","184,32,0,203,255,38,29,217,24,192,161,96,0,0,12,229,174,166,6,7,20,3,84,0,247,96,193,181,229,128,0,32,32]).buffer"," will be used","Staging","Target video element (","robustness","). It has to be a string containing a JWT.","prLicenseUrl","videoElement","isInteger","keys","bytesSinceKey","playoutDelayHint","1404023gQClSZ","encryptionScheme","x-dt-custom-data","Chrome","8184JIDHCT","SampleAuxInfo extraction failed (video)","sinf","Multiview (several DRM configs) detected, rtcDrmOnTrack have to be called with target DRM config.","Safari doesn't support 'cenc'/AES-CTR, use 'cbcs' instead if possible.","12680190VXiNrN","6yLeBUQ","track","size","wvCertificateUrl","keyId","buffered","vendor","bind","seq","Default transform mode enabled, ","PlayReady","stringify","Production","arrayBuffer"," bytes)","forEach","string","object","Frame gap: ","streams","cbcs-1-9","toISOString","now","warn","name","Safari does not support Opus, audio won't be rendered.","nextKeyFrameAllowedTime","playbackRate","11mczGIY","worker","495WPiRWX","userId","55700fhsyWd","jmuxer","jitterBufferDelayHint","slice","enabled","rtcdrmerror","0;function generateDummyFrame($){return(brokenFrame||initializeDummyFrames(),$)?brokenFrame:idrFrames[idrPicIdTog","Unable to create Worker!","src","platform","catch","DRM config robustness can only be one of: ","persistent-license","const DUMMY_IDR_FRAME_SLICE_HDR0=new Uint8Array([32,0,203]),DUMMY_IDR_FRAME_SLICE_HDR1=new Uint8Array([16,0,50]);"," bytes","serverCertificateUrl","navigator","addEventListener","certificate","set","wvLicenseUrl","videoStartTimestamp","reportDiscontinuity","sessionId","length","end","enqueue","Discarding corrupted video frame (too small)",",255]).buffer,idrFrames.push(new Uint8Array([0,0,0,1,39,100,0,13,172,87,5,6,100,0,0,0,1,40,238,60,176,0,0,0,1,37,","saiIvSize","receiver","audio","com.widevine.alpha","includes","status","cbcs","Invalid videoElement, it must be an instance of HTMLVideoElement.","2000","a1d1f1","Windows","MSE (re)init","timestamp","systemID","both","clear","Android","lastKeyFrameTime","5315652RyHiZD","org.w3.clearkey","com.apple.fps","use rtcDrmFeedFrame to push frames manually","debugLog","offset","serverCertificate","12456507CHdSkc"];return(Ne=function(){return e})()}function Pe(e,t,n){const r=ae;return e[r(274)]&&e.audio[r(315)]!==r(287)?t[r(369)][r(354)]>0&&Ce(e,t):n&&n[r(269)](t),!1}function He(t){const n=ae;if(!t||typeof t!==n(470))throw new TypeError(n(418));if(!(t[n(438)]instanceof HTMLVideoElement))throw new TypeError(n(279));if(t[n(381)]&&!(t[n(381)]instanceof HTMLMediaElement))throw new TypeError(n(412));if(void 0!==t[n(341)]&&!Number[n(439)](t.mediaBufferMs))throw new TypeError("DRM config mediaBufferMs should be an integer.");let r=!1,s=!1,i=!1;const o=[n(278),"cenc","clear"],a=["SW","HW"];for(const e of[t[n(375)],t[n(274)]])if(e){if(!o[n(276)](e[n(315)]))throw new RangeError(n(421)+o[n(382)](", "));if(fe&&e.encryption===n(429))throw new RangeError(n(451));if(e[n(315)]!==n(287)){if(s=!0,e[n(457)]){if(!(e[n(457)]instanceof Uint8Array)||16!==e[n(457)][n(267)])throw new TypeError(n(320));i=!0}else if(fe)throw new ReferenceError(n(311));if(e.iv&&(!(e.iv instanceof Uint8Array)||16!==e.iv[n(267)]))throw new TypeError(n(364));if(e[n(435)]&&!a.includes(e[n(435)]))throw new RangeError(n(254)+a[n(382)](", "));fe&&e===t[n(274)]&&"opus"===e.codec&&(r=!0,console[n(391)](n(478)))}}if(s){const e=[M[n(363)],M[n(433)],M[n(465)]];if(!e[n(276)](t.environment))throw new RangeError(n(359)+e[n(382)](", "));if(t[n(377)]&&typeof t[n(377)]!==n(469))throw new TypeError(n(327)+typeof t.authToken+n(436));if(t.type)if(fe){if("FairPlay"!==t[n(338)])throw new RangeError(n(407)+t[n(338)]+n(366))}else if(me){if(t.type!==n(358)&&t[n(338)]!==n(336))throw new RangeError(n(407)+t.type+"). Chrome only supports Widevine and ClearKey.")}else if(pe&&t.type!==n(463)&&"Widevine"!==t[n(338)]&&t[n(338)]!==n(336))throw new RangeError("Invalid DRM type ("+t[n(338)]+n(367))}void 0!==t[n(294)]&&(window[n(410)]=t[n(294)]),void 0!==t[n(427)]&&(window[n(386)]=t[n(427)]);let c=Ie[n(411)](t[n(438)]);!c&&(c=new Ue(t),Ie[n(262)](t.videoElement,c)),c[n(247)]=s,c[n(356)]=r,c.audioEncrypted=!r&&c[n(274)]&&c[n(274)][n(315)]!==n(287),void 0!==t.mediaBufferMs&&(c[n(341)]=t[n(341)]),s&&(!c[n(338)]&&(c[n(338)]=fe?"FairPlay":n(358)),!i&&c[n(338)]!==n(336)&&(c[n(338)]=n(336)),Te(c),function(t){e(this,void 0,void 0,(function*(){const e=Me;var n,r;let s=t[e(438)];if((!t.video||t[e(375)][e(315)]===e(287))&&(s=t.audioElement),!s)throw new Error(e(370));s[e(251)]="",s[e(318)]=null,yield s.setMediaKeys(null);let i=null;try{i=yield navigator[e(373)](t[e(416)],t[e(409)])}catch(e){}if(!i&&t[e(409)][0]){const s=null===(n=t[e(409)][0][e(313)])||void 0===n?void 0:n.indexOf(e(255));if(void 0!==s&&s>=0){null===(r=t[e(409)][0][e(313)])||void 0===r||r[e(353)](s,1);try{i=yield navigator[e(373)](t.keySystem,t[e(409)])}catch(e){}}}if(!i){const n=e(379)+t[e(416)]+e(400);return s[e(351)](new CustomEvent(e(248),{detail:{message:n}})),void console[e(391)](n)}let o=null;try{o=yield i.createMediaKeys()}catch(e){}if(!o){const n=e(402)+t.keySystem+e(400);return s[e(351)](new CustomEvent(e(248),{detail:{message:n}})),void console[e(391)](n)}if(t[e(296)])window.clRtcDrmDebugLog&&console[e(330)]("Applying pre-configured certificate ("+t.serverCertificate.byteLength+e(467)),yield o.setServerCertificate(t[e(296)]);else if(t[e(258)]){const n={method:e(323)},r=t[e(258)];try{const i=yield t[e(298)]?t[e(298)](r,n):fetch(r,n);if(!i.ok){const t="Server certificate fetch failed with error "+i[e(277)];return void s[e(351)](new CustomEvent(e(248),{detail:{message:t}}))}const a=yield i[e(466)]();window[e(410)]&&console[e(330)](e(306)+r+", "+a[e(354)]+e(257)),yield o.setServerCertificate(a)}catch(t){const n=t[e(477)]+": "+t[e(333)];return console[e(391)](n),void s.dispatchEvent(new CustomEvent(e(248),{detail:{message:n}}))}}yield s[e(390)](o),s.addEventListener(e(360),oe),Re(t)}))}(c)),c[n(438)][n(260)](n(345),(function(){const e=n;c[e(438)][e(331)]>.5&&(c[e(479)]=Date[e(475)]())}))}function Oe(e,t){const n=ae;let r=null;try{r=Ke(e)}catch(e){console.warn(e)}if(!Number.isInteger(t))throw new TypeError(n(316));r&&De(r,t)}const ze=ae(256)+ae(312)+ae(271)+ae(431)+ae(392)+ae(249)+'gle^=1]}function audioTransformFunction($,e){postMessage({streamType:"audio",frame:{timestamp:$.timestamp,data:$.'+ae(394)+ae(337)+ae(383)+ae(348)+ae(376)+"meNeeded=$.data};";function Ke(e){const t=ae;if(0===Ie[t(455)])throw new TypeError(t(372));let n;if(e&&e.videoElement)n=e[t(438)];else{if(1!==Ie[t(455)])throw new TypeError(t(450));n=Ie[t(440)]()[t(321)]().value}const r=Ie[t(411)](n);if(!r){let e="";throw Ie[t(468)](((t,n)=>{e+=n.id+", "})),e=e[t(246)](0,-2),new TypeError(t(434)+n.id+t(304)+e+"]")}return r}function Ve(e,t){const n=ae;if(e&&e[n(438)]){if(e[n(438)][n(458)][n(267)]>0){const r=e[n(438)][n(458)][n(268)](e[n(438)][n(458)].length-1)-e[n(438)][n(331)];t[n(442)]=t[n(245)]=t[n(384)]=r}setTimeout(Ve,1e3,e,t)}}function qe(e,t){const n=ae;var r,s;const i=e[n(454)][n(319)];"video"===i&&(e[n(273)][n(442)]=e[n(273)].jitterBufferDelayHint=e[n(273)][n(384)]=0);const o=Ke(t);if(o[n(247)]){if(o.customTransform)window.clRtcDrmDebugLog&&console[n(330)](n(408)+n(293));else if(window[n(410)]&&console[n(330)](n(462)+((ue?"RTCRtpScriptTransform":n(415))+n(432))),ue){if(o[n(240)]=function(e){const t=ae,n=window[t(317)]||window.webkitURL,r=window[t(401)],s=window[t(328)];if(!(n&&r&&s&&e))return null;const i=new r([e]);return new s(n[t(399)](i))}(ze),null==o[n(240)])throw new Error(n(250));o[n(240)].onmessage=e=>{const t=n;e.data.streamType===t(375)?Be(o,e[t(369)][t(361)],null):Pe(o,e[t(369)][t(361)],null)},e.receiver[n(414)]=new RTCRtpScriptTransform(o.worker,{operation:i})}else{const t="video"===i?Be:Pe,r={drm:o,transform:(e,n)=>{t(o,e,n)}},s=e.receiver[n(415)](),a=new TransformStream({transform:r[n(414)][n(460)](r)}),{readable:c,writable:d}=s;c[n(332)](a).pipeTo(d)}if(i===n(274)&&(null===(r=o.audio)||void 0===r?void 0:r[n(315)])===n(287)){if(!o[n(381)])return void console.warn(n(305));o.audioElement.srcObject!==e.streams[0]&&(o[n(381)][n(318)]=e.streams[0]),o[n(438)]&&(e[n(273)][n(442)]=e.receiver[n(245)]=e[n(273)][n(384)]=o[n(341)],Ve(o,e.receiver))}else i===n(375)&&"clear"===(null===(s=o[n(375)])||void 0===s?void 0:s[n(315)])&&o[n(438)][n(318)]!==e[n(472)][0]&&(o.videoElement[n(318)]=e[n(472)][0])}else o[n(438)][n(318)]!==e[n(472)][0]&&(o.videoElement.srcObject=e[n(472)][0])}export{He as rtcDrmConfigure,M as rtcDrmEnvironments,Fe as rtcDrmFeedFrame,U as rtcDrmGetVersion,qe as rtcDrmOnTrack,Oe as rtcDrmSetBufferSize};
